(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2491a9a9"],{"1d11":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message"},[s("el-row",{staticClass:"header",attrs:{type:"flex",justify:"space-between",gutter:6}},[s("el-col",{attrs:{xs:12,sm:6,md:6,lg:6,xl:4}},[s("el-input",{attrs:{placeholder:"请输入昵称",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e._getMessage(t)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),s("el-col",{attrs:{xs:12,sm:6,md:6,lg:6,xl:4}},[s("el-select",{staticStyle:{display:"block"},attrs:{placeholder:"请选择留言状态",clearable:"",size:"small"},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}},e._l(e.stateList,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e.winWidth>500?s("el-col",{attrs:{xs:24,sm:12,md:12,lg:12,xl:16}},[s("el-button",{attrs:{type:"primary",icon:"el-icon-search",round:"",size:"small"},nativeOn:{click:function(t){return e._getMessage(t)}}},[e._v("搜索")]),s("el-button",{attrs:{type:"primary",icon:"el-icon-plus",round:"",size:"small"},on:{click:e.handleAdd}},[e._v("新增")])],1):e._e()],1),e.winWidth<=500?s("el-row",{staticStyle:{padding:"0 10px"},attrs:{type:"flex",justify:"end"}},[s("el-button",{attrs:{type:"primary",icon:"el-icon-search",round:"",size:"small"},nativeOn:{click:function(t){return e._getMessage(t)}}},[e._v("搜索")]),s("el-button",{attrs:{type:"primary",icon:"el-icon-plus",round:"",size:"small"},on:{click:e.handleAdd}},[e._v("新增")])],1):e._e(),s("el-row",{staticClass:"content"},[s("el-col",{attrs:{span:24}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"560",stripe:"",fit:"","highlight-current-row":"",size:"small"}},[s("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-form",{staticClass:"table-expand",attrs:{"label-position":"left",inline:""}},[s("el-form-item",{attrs:{label:"IP："}},[s("span",[e._v(e._s(t.row.ip))])]),s("el-form-item",{attrs:{label:"地址："}},[t.row.country||t.row.city?s("span",[e._v("暂无")]):s("span",[e._v(e._s(t.row.country)+" "+e._s(t.row.city))])]),s("el-form-item",{attrs:{label:"浏览器："}},[s("span",{domProps:{innerHTML:e._s(e.uaParse(t.row.agent))}})]),s("el-form-item",{attrs:{label:"系统："}},[s("span",{domProps:{innerHTML:e._s(e.osParse(t.row.agent))}})]),s("el-form-item",{attrs:{label:"点赞数："}},[s("span",{domProps:{innerHTML:e._s(t.row.likes)}})]),s("el-form-item",{attrs:{label:"postId："}},[s("span",{domProps:{innerHTML:e._s(t.row.postId)}})]),s("el-form-item",{attrs:{label:"isReply："}},[s("span",{domProps:{innerHTML:e._s(t.row.isReply)}})]),s("el-form-item",{attrs:{label:"replyId："}},[s("span",{domProps:{innerHTML:e._s(t.row.replyId||"暂无")}})]),s("el-form-item",{attrs:{label:"replyName："}},[s("span",{domProps:{innerHTML:e._s(t.row.replyName||"暂无")}})]),s("el-form-item",{attrs:{label:"吐槽数："}},[s("span",{domProps:{innerHTML:e._s(t.row.dislikes)}})]),s("el-form-item",{attrs:{label:"头像颜色："}},[s("span",{domProps:{textContent:e._s(t.row.color)}})]),s("el-form-item",{attrs:{label:"头像图片："}},[s("span",{domProps:{textContent:e._s(t.row.avator||"暂无")}})]),s("el-form-item",{attrs:{label:"更新时间："}},[s("span",[e._v(e._s(e._f("formatterTime")(t.row.updateDate)))])])],1)]}}])}),s("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50"}}),s("el-table-column",{attrs:{prop:"postType",label:"类型",align:"center",width:"80"}}),s("el-table-column",{attrs:{prop:"name",label:"昵称",width:"120px","show-overflow-tooltip":""}}),s("el-table-column",{attrs:{prop:"email",label:"邮箱",width:"200px","show-overflow-tooltip":""}}),s("el-table-column",{attrs:{prop:"content",label:"内容","min-width":"200px","show-overflow-tooltip":""}}),s("el-table-column",{attrs:{label:"创建时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("i",{staticClass:"iconfont icon-date mar"}),e._v("\n            "+e._s(e._f("formatterTime")(t.row.createDate))+"\n          ")]}}])}),s("el-table-column",{attrs:{label:"状态",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(0===t.row.state?"待审核":1===t.row.state?"通过":"不通过")+"\n          ")]}}])}),s("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("transition-group",{attrs:{tag:"span",name:"btn"}},[0===t.row.state||2===t.row.state?s("el-button",{key:"1",attrs:{type:"success",size:"small"},on:{click:function(s){return e.handleState(t.row,1)}}},[e._v("通过")]):e._e(),0===t.row.state||1===t.row.state?s("el-button",{key:"2",attrs:{type:"danger",size:"small"},on:{click:function(s){return e.handleState(t.row,2)}}},[e._v("不通过")]):e._e(),s("el-button",{key:"3",attrs:{type:"danger",size:"small",disabled:t.row.deleteing},on:{click:function(s){return e.handleDelete(t.row)}}},[e._v(e._s(t.row.deleteing?"删除中":"删 除"))])],1)]}}])})],1),s("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,"page-sizes":[10,30,50,100],layout:"total, sizes, prev, pager, next"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),s("el-dialog",{attrs:{title:1===e.dialogType?"添加":"编辑",visible:e.dialogVisible,width:e.winWidth<500?"90%":e.winWidth<1200?"60%":"30%","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("el-form",{ref:"messageForm",attrs:{model:e.messageForm,rules:e.messageFormRules,"label-width":"80px","status-icon":""}},[s("el-form-item",{attrs:{label:"昵称",required:"",prop:"name"}},[s("el-input",{attrs:{placeholder:"请输入昵称",clearable:"",size:"small"},model:{value:e.messageForm.name,callback:function(t){e.$set(e.messageForm,"name",t)},expression:"messageForm.name"}})],1),s("el-form-item",{attrs:{label:"邮箱",required:"",prop:"email"}},[s("el-input",{attrs:{placeholder:"请输入邮箱",clearable:"",size:"small"},model:{value:e.messageForm.email,callback:function(t){e.$set(e.messageForm,"email",t)},expression:"messageForm.email"}})],1),s("el-form-item",{attrs:{label:"URL",required:"",prop:"url"}},[s("el-input",{attrs:{placeholder:"请输入URL",clearable:"",size:"small"},model:{value:e.messageForm.url,callback:function(t){e.$set(e.messageForm,"url",t)},expression:"messageForm.url"}})],1),s("el-form-item",{attrs:{label:"内容",required:"",prop:"content"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSubmitForm(t)}}},[s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容",size:"small"},model:{value:e.messageForm.content,callback:function(t){e.$set(e.messageForm,"content",t)},expression:"messageForm.content"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleSubmitForm}},[e._v("确 定")])],1)],1)],1)},n=[],i=(s("7f7f"),s("75fc")),o=(s("a481"),s("28a5"),s("4917"),function(e){var t=new Array,s="";if(t=e.match(/MSIE\s([^\s|]+)/gi))s='<span class="ua_ie"><i class="iconfont icon-internet"></i>Internet Explorer | '.concat(t[0].replace("MSIE","").split(".")[0]);else if(t=e.match(/FireFox\/([^\s]+)/gi)){var a=t[0].split("/");s='<span class="ua_firefox"><i class="iconfont icon-internet"></i>Mozilla FireFox | '.concat(a[1])}else if(t=e.match(/Maxthon([\d]*)\/([^\s]+)/gi)){t[0].split("/");s='<span class="ua_maxthon"><i class="iconfont icon-internet"></i>Maxthon'}else if(t=e.match(/UBrowser([\d]*)\/([^\s]+)/gi)){var n=t[0].split("/");s='<span class="ua_ucweb"><i class="iconfont icon-internet"></i>UCBrowser | '.concat(n[1])}else if(t=e.match(/MetaSr/gi))s='<span class="ua_sogou"><i class="iconfont icon-internet"></i>搜狗浏览器';else if(t=e.match(/2345Explorer/gi))s='<span class="ua_2345explorer"><i class="iconfont icon-internet"></i>2345王牌浏览器';else if(t=e.match(/2345chrome/gi))s='<span class="ua_2345chrome"><i class="iconfont icon-internet"></i>2345加速浏览器';else if(t=e.match(/LBBROWSER/gi))s='<span class="ua_lbbrowser"><i class="iconfont icon-internet"></i>猎豹安全浏览器';else if(t=e.match(/MicroMessenger\/([^\s]+)/gi)){var i=t[0].split("/");s='<span class="ua_qq"><i class="iconfont icon-wechat"></i>微信 | '.concat(i[1].split("/")[0])}else if(t=e.match(/QQBrowser\/([^\s]+)/gi)){var o=t[0].split("/");s='<span class="ua_qq"><i class="iconfont icon-internet"></i>QQ浏览器 | '.concat(o[1].split("/")[0])}else if(t=e.match(/QQ\/([^\s]+)/gi)){var l=t[0].split("/");s='<span class="ua_qq"><i class="iconfont icon-internet"></i>QQ浏览器 | '.concat(l[1].split("/")[0])}else if(t=e.match(/MiuiBrowser\/([^\s]+)/gi)){var r=t[0].split("/");s='<span class="ua_mi"><i class="iconfont icon-internet"></i>Miui浏览器 | '.concat(r[1].split("/")[0])}else if(t=e.match(/Chrome([\d]*)\/([^\s]+)/gi)){var c=t[0].split("/");s='<span class="ua_chrome"><i class="iconfont icon-internet"></i>Chrome | '.concat(c[1].split(".")[0])}else if(t=e.match(/safari\/([^\s]+)/gi)){var m=t[0].split("/");s='<span class="ua_apple"><i class="iconfont icon-internet"></i>Apple Safari | '.concat(m[1])}else if(t=e.match(/Opera[\s|\/]([^\s]+)/gi)){t[0].split("/");s='<span class="ua_opera"><i class="iconfont icon-internet"></i>Opera | '.concat(t[1])}else s=(t=e.match(/Trident\/7.0/gi))?'<span class="ua_ie"><i class="iconfont icon-internet"></i>Internet Explorer 11':'<span class="ua_other"><i class="iconfont icon-internet"></i>其它浏览器';return"".concat(s,"</span>")}),l=function(e){var t="";return t=e.match(/win/gi)?e.match(/nt 5.1/gi)?'<span class="os_xp"><i class="iconfont icon-windows"></i>Windows XP':e.match(/nt 6.1/gi)?'<span class="os_7"><i class="iconfont icon-windows"></i>Windows 7':e.match(/nt 6.2/gi)?'<span class="os_8"><i class="iconfont icon-windows"></i>Windows 8':e.match(/nt 6.3/gi)?'<span class="os_8_1"><i class="iconfont icon-windows"></i>Windows 8.1':e.match(/nt 10.0/gi)?'<span class="os_8_1"><i class="iconfont icon-windows"></i>Windows 10':e.match(/nt 6.0/gi)?'<span class="os_vista"><i class="iconfont icon-windows"></i>Windows Vista':e.match(/nt 5/gi)?'<span class="os_2000"><i class="iconfont icon-windows"></i>Windows 2000':'<span class="os_windows"><i class="iconfont icon-windows"></i>Windows':e.match(/android/gi)?'<span class="os_android"><i class="iconfont icon-android"></i>Android':e.match(/ubuntu/gi)?'<span class="os_ubuntu">Ubuntu':e.match(/linux/gi)?'<span class="os_linux"><i class="iconfont icon-linux"></i>Linux':e.match(/iphone/gi)?'<span class="os_mac"><i class="iconfont icon-mac"></i>iPhone OS':e.match(/mac/gi)?'<span class="os_mac"><i class="iconfont icon-mac"></i>Mac OS X':e.match(/unix/gi)?'<span class="os_unix"><i class="iconfont icon-unix"></i>Unix':'<span class="os_other"><i class="iconfont icon-phone"></i>Other',"".concat(t,"</span>")},r=s("393b"),c=s("8a1f"),m={name:"message",data:function(){var e=function(e,t,s){console.log(Object(c["a"])(t)),""===t?s(new Error("请输入邮箱")):Object(c["a"])(t)?s():s(new Error("请正确输入邮箱"))},t=function(e,t,s){console.log(Object(c["c"])(t)),""===t?s(new Error("请输入URL")):Object(c["c"])(t)?s():s(new Error("请正确输入URL"))};return{keyword:"",state:"",stateList:[{value:"3",label:"全部"},{value:"0",label:"待审核"},{value:"1",label:"已通过"},{value:"2",label:"未通过"}],messageForm:{id:void 0,name:"",email:"",url:"",content:""},messageFormRules:{name:[{required:!0,message:"请输入昵称",trigger:"blur"},{required:!0,message:"请输入昵称",trigger:"change"}],email:[{validator:e,trigger:"blur"},{validator:e,trigger:"change"}],url:[{validator:t,trigger:"blur"},{validator:t,trigger:"change"}],content:[{required:!0,message:"请输入内容",trigger:"blur"},{required:!0,message:"请输入内容",trigger:"change"}]},dialogVisible:!1,dialogType:1,tableData:[],currentPage:1,pageSize:10,total:0,loading:!1}},created:function(){this._getMessage()},filters:{formatterTime:r["a"]},mounted:function(){this.$nextTick(function(){})},methods:{_getMessage:function(e){var t=this;this.loading=!0,this.$store.dispatch("message/getMessage",{currentPage:this.currentPage,pageSize:this.pageSize,keyword:this.keyword,state:this.state}).then(function(e){e.success?(t.tableData=Object(i["a"])(e.data.list),t.total=e.data.pagination.total,t.pageSize=e.data.pagination.pageSize,t.currentPage=e.data.pagination.currentPage):t.$message.error(e.msg)}).then(function(){t.loading=!1})},uaParse:function(e){return o(e)},osParse:function(e){return l(e)},handleSizeChange:function(e){this.pageSize=e,this._getMessage()},handleCurrentChange:function(e){this.currentPage=e,this._getMessage()},handleAdd:function(){var e=this;this.messageForm.id="",this.messageForm.name="",this.messageForm.email="",this.messageForm.url="",this.messageForm.content="",this.dialogType=1,this.dialogVisible=!0,this.$nextTick(function(){e.$refs["messageForm"].clearValidate()})},handleSubmitForm:function(){var e=this;this.$refs.messageForm.validate(function(t){if(t){var s={name:e.messageForm.name,email:e.messageForm.email,url:e.messageForm.url,content:e.messageForm.content,agent:navigator.userAgent};e.$store.dispatch("message/postMessage",s).then(function(t){t.success?(e._getMessage(),e.dialogVisible=!1,e.$message.success(t.msg)):e.$message.error(t.msg)})}})},handleState:function(e,t){var s=this;this.$store.dispatch("message/patchMessage",{_id:e._id,state:t,postId:e.postId}).then(function(e){console.log(e),e.success?(s.$message({message:e.msg,type:"success"}),s._getMessage()):s.$message({message:e.msg,type:"error"})})},handleDelete:function(e){var t=this;console.log(e),this.$confirm("此操作将删除该行, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s="";s=e.postId?"".concat(e._id,",").concat(e.postId):e._id,t.$store.dispatch("message/deleteMessage",s).then(function(e){e.success?(t.$message({message:e.msg,type:"success"}),t._getMessage()):t.$message({message:e.msg,type:"error"})})}).catch(function(){})}}},u=m,p=(s("f762"),s("2877")),g=Object(p["a"])(u,a,n,!1,null,"4bc5d198",null);t["default"]=g.exports},e84a:function(e,t,s){},f762:function(e,t,s){"use strict";var a=s("e84a"),n=s.n(a);n.a}}]);